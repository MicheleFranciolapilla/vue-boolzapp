<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <!-- Link a Font Awesome 6 -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.3.0/css/all.min.css" integrity="sha512-SzlrxWUlpfuzQ+pcUCosxcglQRNAq/DZjVsC0lE40xsADsfeQoEypE+enwcOiGjk/bSuGGKHEyjSoQ1zVisanQ==" crossorigin="anonymous" referrerpolicy="no-referrer" />

    <!-- Link a Bootstrap 5 -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">

    <!-- Link ai fogli di stile dedicati -->
    <link rel="stylesheet" href="./assets/css/reset_and_utilities.css">
    <link rel="stylesheet" href="./assets/css/style.css">

    <title>Vue - Boolzapp</title>
</head>
<body>

    <div id="vue_app">
        <!-- Titolo h1 in position fixed per non sottrarre spazio al contenitore web_app -->
        <h1 class="fixed-top text-center text-white fs-3">Vue Boolzapp <span class="fs-4 text-white-50">{{(check_if_large) ? ('(Large)') : ('(Small)')}}</span></h1>
        <!-- Ricordarsi di impostare il background a gradiente -->
        <div id="web_app" class="vh-100 container-fluid d-flex justify-content-center align-items-center bg-success">
            <div v-if="some_error" id="error_manager">
                <div id="error_message" class="row py-3 px-2 px-lg-5 border border-5 border-danger rounded-3 text-danger bg-warning">
                    <p>{{error_array[some_error]}}</p>
                    <button class="col-2 offset-5 btn btn-info btn-outline-primary" v-on:click="reset_error()">OK</button>
                </div>
            </div>
            <main class="row p-0 m-0">
                <!-- La prima sezione (lista dei contatti) verrà visualizzata se il dispositivo è large (a prescindere che sia attiva o meno la chat) oppure se, con dispositivo small, non è attiva la chat -->
                <section id="friends_side"
                        v-if="((check_if_large) || (!chat_is_active))"
                        v-bind:class="(check_if_large) ? ('col-5') : ('col-12')" 
                        v-bind:style="(chat_is_active) ? ('opacity: 0.7') : ('opacity: 1')">
                    <div class="section_header px-2">
                        <div class="person">
                            <img src="./assets/img/avatar_io.jpg" class="rounded-circle" alt="avatar_personale">
                            <span>Sofia</span>
                        </div>
                        <div class="icons_set">
                            <span><i class="fa-solid fa-circle-notch"></i></span>
                            <span><i class="fa-solid fa-message"></i></span>
                            <span><i class="fa-solid fa-ellipsis-vertical"></i></span>
                        </div>
                    </div>
                    <div id="notifications" class="px-3">
                        <div id="bell_circle" v-on:click="allow_notifications = !allow_notifications">
                            <i v-if="allow_notifications" class="fa-solid fa-bell"></i>
                            <i v-else class="fa-solid fa-bell-slash"></i>
                        </div>
                        <div id="notifications_text">
                            <span class="text-black-50">Ricevi notifiche messaggi</span>
                            <a href="#" v-on:click="allow_notifications = !allow_notifications">{{(allow_notifications) ? ("Disattiva notifiche desktop") : ("Attiva notifiche desktop")}}</a>
                        </div>
                    </div>
                    <div id="search_area" class="px-3 py-1">
                        <form id="search_form" class="w-100 border border-3 rounded-1 d-flex">
                            <button class="btn btn-outline-success" type="submit"><i class="fa-sharp fa-solid fa-magnifying-glass"></i></button>
                            <input id="data_input" class="form-control" type="text" v-model="search_data" placeholder="Cerca o inizia una nuova chat" aria-label="Search" v-on:keyup="searching()">
                        </form>
                    </div>
                    <div id="contact_list">
                        <div v-for="(item, index) in contacts" :key="index" class="contact ps-3 pe-2" 
                        v-bind:class="(index==active_contact) ? ('active') : ('')"
                        v-bind:style="(!item.visible) ? ('display: none;') : ('')" v-on:click="new_active(index)">
                            <div class="person">
                                <img v-bind:src="item.avatar" class="rounded-circle" v-bind:alt=`Avatar_nr_${index}`>
                                <div class="person_details align-self-start">
                                    <span style="font-size: xx-small;">{{item.name}}</span>
                                    <span class="show_last_msg" style="font-size: xx-small;">{{check_last_sent_plus_output(index,1)}}</span>
                                </div>
                            </div>
                            <span style="font-size: xx-small;" class="align-self-start">{{check_last_sent_plus_output(index,2)}}</span>
                        </div>
                    </div>
                </section>
                <!-- La seconda sezione (chat) verrà visualizzata se il dispositivo è large (a prescindere che sia attiva o meno la chat) oppure se, con dispositivo small, la chat risulti attiva -->
                <section id="chat_side"
                        v-if="((check_if_large) || (chat_is_active))" 
                        v-bind:class="(check_if_large) ? ('col-7') : ('col-12')"
                        v-bind:style="(chat_is_active) ? ('opacity: 1') : ('opacity: 0.7')">
                    <div class="section_header px-2">
                        <div class="person">
                            <img v-bind:src="contacts[active_contact].avatar" class="rounded-circle" v-bind:alt=`Avatar_nr_${active_contact}`>
                            <div class="person_details">
                                <span>{{contacts[active_contact].name}}</span>
                                <span style="font-size: xx-small;">{{check_last_sent_plus_output(active_contact,0)}}</span>
                            </div>
                        </div>
                        <div class="icons_set">
                            <span><i class="fa-solid fa-magnifying-glass"></i></span>
                            <span><i class="fa-solid fa-paperclip"></i></span>
                            <span><i class="fa-solid fa-ellipsis-vertical"></i></span>
                        </div>
                    </div>
                </section>
            </main>
        </div>
    </div>

    <!-- Axios CDN -->
    <!-- <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script> -->
    <!-- Boolean 5 CDN -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js" integrity="sha384-MrcW6ZMFYlzcLA8Nl+NtUVF0sA7MsXsP1UyJoMp4YLEuNSfAP+JcXn/tWtIaxVXM" crossorigin="anonymous"></script>
    <!-- Vue 3 CDN -->
    <script src="https://unpkg.com/vue@3/dist/vue.global.js"></script>
    <!-- File di script dedicato -->
    <script src="./assets/js/main.js"></script>
</body>
</html>